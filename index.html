<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doğu Kervan - Blog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-slow {
            animation: pulse-slow 2s ease-in-out infinite;
        }
        /* Dark theme colors */
        :root { color-scheme: dark; }
        .card-dark { background: rgba(20,20,20,0.7); border-color: rgba(255,255,255,0.08); }
        .card-dark:hover { background: rgba(32,32,32,0.9); }
    </style>
</head>
<body class="min-h-screen bg-black text-white">
    <div class="container mx-auto px-4 py-12 max-w-4xl">
        <!-- Header Section -->
        <header class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-bold mb-4">Doğu Kervan</h1>
            <p class="text-xl md:text-2xl opacity-70">Developer • Writer • CyberSecurity Enthusiast</p>
        </header>

        <!-- Discord Status Card -->
        <div class="card-dark backdrop-blur-md rounded-2xl p-6 mb-8 shadow-2xl border">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <i class="fab fa-discord text-indigo-300"></i>
                Discord Status
            </h2>
            <div id="discord-status" class="flex flex-col md:flex-row items-center gap-6">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <img id="discord-avatar" src="" alt="Discord Avatar" class="w-20 h-20 rounded-full border-4 border-white/20 hidden">
                        <div id="status-indicator" class="absolute bottom-0 right-0 w-6 h-6 rounded-full border-4 border-white"></div>
                    </div>
                    <div id="discord-info">
                        <p class="text-lg font-semibold" id="discord-username">Loading...</p>
                        <p class="text-sm opacity-75" id="discord-status-text">Fetching status...</p>
                    </div>
                </div>
                <div id="discord-activity" class="flex-1 w-full">
                    <!-- Activity will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Latest Posts from RSS -->
        <div class="card-dark backdrop-blur-md rounded-2xl p-6 mb-8 shadow-2xl border">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <i class="fas fa-newspaper text-gray-300"></i>
                Latest Posts
            </h2>
            <div id="rss-posts" class="space-y-4">
                <p class="opacity-70 text-sm">Loading latest posts...</p>
            </div>
        </div>

        <!-- Blog & Social Links -->
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- RSS Feed Card -->
            <a href="https://blog.dogukervan.me/" target="_blank" 
               class="card-dark backdrop-blur-md rounded-2xl p-6 shadow-2xl border hover:scale-105 transition-all duration-300">
                <div class="flex items-center gap-4">
                    <div >
                        <i class="fas fa-calendar text-3xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold">Blog</h3>
                        <p class="opacity-70">Read my articles.</p>
                    </div>
                </div>
            </a>

            <!-- LinkedIn Card -->
            <a href="https://www.linkedin.com/in/do%C4%9Fu-kervan-79504b382" target="_blank"
               class="card-dark backdrop-blur-md rounded-2xl p-6 shadow-2xl border hover:scale-105 transition-all duration-300">
                <div class="flex items-center gap-4">
                    <div>
                        <i class="fab fa-linkedin text-3xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold">LinkedIn</h3>
                        <p class="opacity-70">Connect with me professionally</p>
                    </div>
                </div>
            </a>
        </div>

        

        <!-- HackTheBox Stats (HTB API direct JSON) -->
        <section class="card-dark backdrop-blur-md rounded-2xl p-6 shadow-2xl border mb-8" href="google.com"">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <i class="fas fa-chart-line text-green-300"></i>
                HackTheBox Stats
            </h2>
            <div id="htb-stats-custom" class="w-full">
                <p class="opacity-70 text-sm">Loading HackTheBox stats...</p>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center mt-12 opacity-75">
            <p>&copy; 2025 Doğu Kervan. All rights reserved.</p>
            <p class="mt-2">
                <i class="fas fa-envelope"></i>
                <a href="mailto:dogu.kervan@computer.org" class="underline hover:no-underline">dogu.kervan@computer.org</a>
            </p>
            <!-- Badges Row -->
            <div class="mt-6 flex flex-wrap items-center justify-center gap-3">
                <!-- Powered by Ubuntu -->
                <a href="https://ubuntu.com" target="_blank" rel="noopener noreferrer"
                   class="hover:opacity-90" title="Powered by Ubuntu">
                    <img
                        src="https://img.shields.io/badge/Powered%20by-Ubuntu-E95420?logo=ubuntu&logoColor=white&labelColor=2D2D2D&style=flat-square"
                        alt="Powered by Ubuntu"
                        class="h-6"
                    >
                </a>

                <!-- Get free 7-Zip -->
                <a href="https://www.7-zip.org/" target="_blank" rel="noopener noreferrer"
                   class="hover:opacity-90" title="Get free 7-Zip">
                    <img
                        src="https://img.shields.io/badge/Get%20free-7--Zip-0054A6?logo=7zip&logoColor=white&labelColor=2D2D2D&style=flat-square"
                        alt="Get free 7-Zip"
                        class="h-6"
                    >
                </a>

                <!-- Cookie-free site -->
                <span class="hover:opacity-90" title="This site is 100% cookie-free!">
                    <img
                        src="https://img.shields.io/badge/This%20site%20is-100%25%20cookie%20free!-6E7F80?logo=cookiecutter&logoColor=white&labelColor=2D2D2D&style=flat-square"
                        alt="This site is 100% cookie-free"
                        class="h-6"
                    >
                </span>

                <!-- Retro computer & monitor vibe -->
                <span class="hover:opacity-90" title="a computer and a monitor">
                    <img
                        src="https://img.shields.io/badge/a%20computer-and%20a%20monitor-777777?logo=gnome&logoColor=white&labelColor=2D2D2D&style=flat-square"
                        alt="a computer and a monitor"
                        class="h-6"
                    >
                </span>
            </div>
        </footer>
    </div>

    <script>
        const DISCORD_ID = '1401588534007300310';
        const LANYARD_API = `https://api.lanyard.rest/v1/users/${DISCORD_ID}`;
        const RSS_URL = 'https://blog.dogukervan.me/feed.xml';
        const HTB_ID = '2433453';
        const HTB_PROFILE_API = `https://labs.hackthebox.com/api/v4/profile/${HTB_ID}`;
        // Use CORS-friendly mirrors first, then fall back to direct API
        const HTB_ENDPOINTS = [
            `https://r.jina.ai/http://labs.hackthebox.com/api/v4/profile/${HTB_ID}`,
            `https://cors.isomorphic-git.org/https://labs.hackthebox.com/api/v4/profile/${HTB_ID}`,
            `https://api.allorigins.win/raw?url=${encodeURIComponent(`https://labs.hackthebox.com/api/v4/profile/${HTB_ID}`)}`,
            HTB_PROFILE_API
        ];

        async function fetchDiscordStatus() {
            try {
                const response = await fetch(LANYARD_API);
                const data = await response.json();
                
                if (data.success && data.data) {
                    const user = data.data;
                    
                    // Update avatar
                    const avatar = document.getElementById('discord-avatar');
                    avatar.src = `https://cdn.discordapp.com/avatars/${user.discord_user.id}/${user.discord_user.avatar}.png?size=128`;
                    avatar.classList.remove('hidden');
                    
                    // Update username
                    document.getElementById('discord-username').textContent = 
                        user.discord_user.global_name || user.discord_user.username;
                    
                    // Update status indicator
                    const statusIndicator = document.getElementById('status-indicator');
                    const statusColors = {
                        'online': 'bg-green-500',
                        'idle': 'bg-yellow-500',
                        'dnd': 'bg-red-500',
                        'offline': 'bg-gray-500'
                    };
                    statusIndicator.className = `absolute bottom-0 right-0 w-6 h-6 rounded-full border-4 border-white ${statusColors[user.discord_status] || 'bg-gray-500'}`;
                    
                    // Update status text
                    const statusText = user.discord_status.charAt(0).toUpperCase() + user.discord_status.slice(1);
                    document.getElementById('discord-status-text').textContent = statusText;
                    
                    // Update activity
                    const activityContainer = document.getElementById('discord-activity');
                    if (user.activities && user.activities.length > 0) {
                        const activity = user.activities[0];
                        let activityHTML = '<div class="bg-white/10 rounded-lg p-4">';
                        
                        if (activity.type === 2) { // Spotify
                            activityHTML += `
                                <div class="flex items-center gap-3">
                                    <i class="fab fa-spotify text-green-400 text-2xl"></i>
                                    <div class="flex-1">
                                        <p class="text-sm opacity-75">Listening to Spotify</p>
                                        <p class="font-semibold">${activity.details || 'Unknown Track'}</p>
                                        <p class="text-sm opacity-75">${activity.state || ''}</p>
                                    </div>
                                </div>
                            `;
                        } else if (activity.name) {
                            activityHTML += `
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-gamepad text-purple-400 text-2xl"></i>
                                    <div class="flex-1">
                                        <p class="text-sm opacity-75">Playing</p>
                                        <p class="font-semibold">${activity.name}</p>
                                        ${activity.details ? `<p class="text-sm opacity-75">${activity.details}</p>` : ''}
                                    </div>
                                </div>
                            `;
                        }
                        
                        activityHTML += '</div>';
                        activityContainer.innerHTML = activityHTML;
                    } else {
                        activityContainer.innerHTML = '<p class="text-sm opacity-75 italic">No current activity</p>';
                    }
                }
            } catch (error) {
                console.error('Error fetching Discord status:', error);
                document.getElementById('discord-username').textContent = 'Unable to load';
                document.getElementById('discord-status-text').textContent = 'Please try again later';
            }
        }

        // Fetch status on load and update every 30 seconds
        fetchDiscordStatus();
        setInterval(fetchDiscordStatus, 30000);

        async function fetchRSSPosts() {
            try {
                const res = await fetch(RSS_URL, { headers: { 'Accept': 'application/xml' } });
                const text = await res.text();
                const parser = new DOMParser();
                const xml = parser.parseFromString(text, 'application/xml');

                // Try RSS 2.0 first
                let items = Array.from(xml.querySelectorAll('item'));
                // If Atom
                if (items.length === 0) {
                    items = Array.from(xml.querySelectorAll('entry'));
                }

                const postsEl = document.getElementById('rss-posts');
                postsEl.innerHTML = '';

                items.slice(0, 3).forEach(item => {
                    const title = (item.querySelector('title')?.textContent || 'Untitled').trim();
                    const link = (item.querySelector('link')?.textContent || item.querySelector('link')?.getAttribute('href') || '#').trim();
                    const dateStr = (item.querySelector('pubDate')?.textContent || item.querySelector('updated')?.textContent || item.querySelector('published')?.textContent || '').trim();
                    const date = dateStr ? new Date(dateStr) : null;

                    const post = document.createElement('a');
                    post.href = link;
                    post.target = '_blank';
                    post.className = 'flex items-start gap-4 p-4 rounded-xl border card-dark hover:scale-[1.01] transition-all';
                    post.innerHTML = `
                        <div class="bg-gray-700 p-3 rounded-full">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg">${title}</h3>
                            ${date ? `<p class="text-sm opacity-60">${date.toLocaleDateString()}</p>` : ''}
                        </div>
                        <i class="fas fa-arrow-up-right-from-square opacity-60"></i>
                    `;
                    postsEl.appendChild(post);
                });

                if (postsEl.children.length === 0) {
                    postsEl.innerHTML = '<p class="opacity-70 text-sm">No posts found in RSS.</p>';
                }
            } catch (e) {
                const postsEl = document.getElementById('rss-posts');
                postsEl.innerHTML = '<p class="opacity-70 text-sm">Failed to load RSS feed.</p>';
                console.error('RSS fetch error', e);
            }
        }

        fetchRSSPosts();

        async function fetchHTBStats() {
            const container = document.getElementById('htb-stats-custom');
            for (const url of HTB_ENDPOINTS) {
                try {
                    const res = await fetch(url, { headers: { 'accept': 'application/json' } });
                    if (!res.ok) throw new Error(`Fetch failed: ${url}`);
                    const text = await res.text();
                    const data = JSON.parse(text);
                    if (data && data.profile) {
                        renderHTBCard(data.profile);
                        return;
                    }
                } catch (e) {
                    // try next
                    continue;
                }
            }
            console.error('HTB API fetch error: all endpoints failed');
            container.innerHTML = '<p class="opacity-70 text-sm">HTB stats could not be loaded (CORS or API error).</p>';
        }

        function renderHTBCard(profile) {
            const username = profile.name || 'Unknown';
            const points = profile.points ?? '-';
            const systemOwns = profile.system_owns ?? '-';
            const userOwns = profile.user_owns ?? '-';
            const rank = profile.rank || '-';
            const nextRank = profile.next_rank || 'Next Rank';
            const progressRaw = (typeof profile.current_rank_progress === 'number')
                ? profile.current_rank_progress
                : (profile.rank_requirement ? (profile.rank_ownership / profile.rank_requirement) * 100 : 0);
            const progressPct = Math.max(0, Math.min(100, Math.round(progressRaw)));

            const container = document.getElementById('htb-stats-custom');
            container.innerHTML = `
                <div class="rounded-xl border border-white/10 p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <div class="bg-green-600/20 text-green-300 px-3 py-1 rounded-full text-xs font-semibold">HTB</div>
                            <h3 class="text-xl font-semibold">
                                <a href="https://app.hackthebox.com/users/${HTB_ID}" target="_blank" rel="noopener" class="hover:underline">
                                    ${username}
                                </a>
                            </h3>
                        </div>
                        <div class="text-right">
                            <div class="text-sm opacity-70">Rank</div>
                            <div class="font-semibold">${rank}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-4">
                        <div class="card-dark border rounded-lg p-3">
                            <div class="text-xs opacity-70 mb-1">Points</div>
                            <div class="text-lg font-semibold flex items-center gap-2"><i class="fas fa-brain text-green-300"></i>${points}</div>
                        </div>
                        <div class="card-dark border rounded-lg p-3">
                            <div class="text-xs opacity-70 mb-1">System Owns</div>
                            <div class="text-lg font-semibold flex items-center gap-2"><i class="fas fa-desktop text-green-300"></i>${systemOwns}</div>
                        </div>
                        <div class="card-dark border rounded-lg p-3">
                            <div class="text-xs opacity-70 mb-1">User Owns</div>
                            <div class="text-lg font-semibold flex items-center gap-2"><i class="fas fa-user-ninja text-green-300"></i>${userOwns}</div>
                        </div>
                    </div>
                    <div class="mb-1 flex items-center justify-between">
                        <div class="text-sm opacity-70">Progress to ${nextRank}</div>
                        <div class="text-sm opacity-70">${progressPct}%</div>
                    </div>
                    <div class="w-full h-2 bg-neutral-800 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500" style="width: ${progressPct}%"></div>
                    </div>
                </div>
            `;
        }

        fetchHTBStats();
    </script>
</body>
</html>
